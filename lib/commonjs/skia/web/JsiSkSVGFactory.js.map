{"version":3,"names":["_Host","require","_JsiSkSVG","JsiSkSVGFactory","Host","constructor","CanvasKit","MakeFromData","data","decoder","TextDecoder","str","decode","ref","MakeFromString","parser","DOMParser","svgDoc","parseFromString","svgElement","documentElement","attrWidth","getAttribute","attrHeight","width","parseFloat","height","svgDataUrl","encodeURIComponent","img","Image","src","style","display","alt","viewBox","viewBoxValues","split","length","onerror","e","console","error","document","body","appendChild","JsiSkSVG","exports"],"sources":["JsiSkSVGFactory.ts"],"sourcesContent":["import type { CanvasKit } from \"canvaskit-wasm\";\n\nimport type { SkSVG } from \"../types\";\nimport type { SVGFactory } from \"../types/SVG/SVGFactory\";\n\nimport { Host } from \"./Host\";\nimport type { JsiSkData } from \"./JsiSkData\";\nimport { JsiSkSVG } from \"./JsiSkSVG\";\n\nexport class JsiSkSVGFactory extends Host implements SVGFactory {\n  constructor(CanvasKit: CanvasKit) {\n    super(CanvasKit);\n  }\n\n  MakeFromData(data: JsiSkData): SkSVG | null {\n    const decoder = new TextDecoder(\"utf-8\");\n    const str = decoder.decode(data.ref);\n    return this.MakeFromString(str);\n  }\n\n  MakeFromString(str: string): SkSVG | null {\n    const parser = new DOMParser();\n    const svgDoc = parser.parseFromString(str, \"image/svg+xml\");\n    const svgElement = svgDoc.documentElement;\n\n    const attrWidth = svgElement.getAttribute(\"width\");\n    const attrHeight = svgElement.getAttribute(\"height\");\n    let width = attrWidth ? parseFloat(attrWidth) : null;\n    let height = attrHeight ? parseFloat(attrHeight) : null;\n\n    const svgDataUrl =\n      \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(str);\n    // Create a new HTMLImageElement\n    const img = new Image();\n    img.src = svgDataUrl;\n\n    // Optionally set styles or attributes on the image\n    img.style.display = \"none\";\n    img.alt = \"SVG Image\";\n    if (!width || !height) {\n      const viewBox = svgElement.getAttribute(\"viewBox\");\n      if (viewBox) {\n        const viewBoxValues = viewBox.split(\" \");\n        if (viewBoxValues.length === 4) {\n          width = width || parseFloat(viewBoxValues[2]);\n          height = height || parseFloat(viewBoxValues[3]);\n        }\n      }\n    }\n    if (width && height) {\n      img.width = width;\n      img.height = height;\n    }\n\n    img.onerror = (e) => {\n      console.error(\"SVG failed to load\", e);\n    };\n    document.body.appendChild(img);\n    return new JsiSkSVG(this.CanvasKit, img);\n  }\n}\n"],"mappings":";;;;;;AAKA,IAAAA,KAAA,GAAAC,OAAA;AAEA,IAAAC,SAAA,GAAAD,OAAA;AAEO,MAAME,eAAe,SAASC,UAAI,CAAuB;EAC9DC,WAAWA,CAACC,SAAoB,EAAE;IAChC,KAAK,CAACA,SAAS,CAAC;EAClB;EAEAC,YAAYA,CAACC,IAAe,EAAgB;IAC1C,MAAMC,OAAO,GAAG,IAAIC,WAAW,CAAC,OAAO,CAAC;IACxC,MAAMC,GAAG,GAAGF,OAAO,CAACG,MAAM,CAACJ,IAAI,CAACK,GAAG,CAAC;IACpC,OAAO,IAAI,CAACC,cAAc,CAACH,GAAG,CAAC;EACjC;EAEAG,cAAcA,CAACH,GAAW,EAAgB;IACxC,MAAMI,MAAM,GAAG,IAAIC,SAAS,CAAC,CAAC;IAC9B,MAAMC,MAAM,GAAGF,MAAM,CAACG,eAAe,CAACP,GAAG,EAAE,eAAe,CAAC;IAC3D,MAAMQ,UAAU,GAAGF,MAAM,CAACG,eAAe;IAEzC,MAAMC,SAAS,GAAGF,UAAU,CAACG,YAAY,CAAC,OAAO,CAAC;IAClD,MAAMC,UAAU,GAAGJ,UAAU,CAACG,YAAY,CAAC,QAAQ,CAAC;IACpD,IAAIE,KAAK,GAAGH,SAAS,GAAGI,UAAU,CAACJ,SAAS,CAAC,GAAG,IAAI;IACpD,IAAIK,MAAM,GAAGH,UAAU,GAAGE,UAAU,CAACF,UAAU,CAAC,GAAG,IAAI;IAEvD,MAAMI,UAAU,GACd,mCAAmC,GAAGC,kBAAkB,CAACjB,GAAG,CAAC;IAC/D;IACA,MAAMkB,GAAG,GAAG,IAAIC,KAAK,CAAC,CAAC;IACvBD,GAAG,CAACE,GAAG,GAAGJ,UAAU;;IAEpB;IACAE,GAAG,CAACG,KAAK,CAACC,OAAO,GAAG,MAAM;IAC1BJ,GAAG,CAACK,GAAG,GAAG,WAAW;IACrB,IAAI,CAACV,KAAK,IAAI,CAACE,MAAM,EAAE;MACrB,MAAMS,OAAO,GAAGhB,UAAU,CAACG,YAAY,CAAC,SAAS,CAAC;MAClD,IAAIa,OAAO,EAAE;QACX,MAAMC,aAAa,GAAGD,OAAO,CAACE,KAAK,CAAC,GAAG,CAAC;QACxC,IAAID,aAAa,CAACE,MAAM,KAAK,CAAC,EAAE;UAC9Bd,KAAK,GAAGA,KAAK,IAAIC,UAAU,CAACW,aAAa,CAAC,CAAC,CAAC,CAAC;UAC7CV,MAAM,GAAGA,MAAM,IAAID,UAAU,CAACW,aAAa,CAAC,CAAC,CAAC,CAAC;QACjD;MACF;IACF;IACA,IAAIZ,KAAK,IAAIE,MAAM,EAAE;MACnBG,GAAG,CAACL,KAAK,GAAGA,KAAK;MACjBK,GAAG,CAACH,MAAM,GAAGA,MAAM;IACrB;IAEAG,GAAG,CAACU,OAAO,GAAIC,CAAC,IAAK;MACnBC,OAAO,CAACC,KAAK,CAAC,oBAAoB,EAAEF,CAAC,CAAC;IACxC,CAAC;IACDG,QAAQ,CAACC,IAAI,CAACC,WAAW,CAAChB,GAAG,CAAC;IAC9B,OAAO,IAAIiB,kBAAQ,CAAC,IAAI,CAACxC,SAAS,EAAEuB,GAAG,CAAC;EAC1C;AACF;AAACkB,OAAA,CAAA5C,eAAA,GAAAA,eAAA","ignoreList":[]}