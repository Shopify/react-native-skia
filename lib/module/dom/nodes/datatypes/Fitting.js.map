{"version":3,"names":["exhaustiveCheck","size","width","height","rect2rect","src","dst","scaleX","scaleY","translateX","x","translateY","y","inscribe","rect","halfWidthDelta","halfHeightDelta","applyBoxFit","fit","input","output","Math","min","aspectRatio","fitRects","sizes"],"sources":["Fitting.ts"],"sourcesContent":["import { exhaustiveCheck } from \"../../../renderer/typeddash\";\nimport type { SkRect } from \"../../../skia/types\";\nimport type { Fit } from \"../../types\";\n\nexport interface Size {\n  width: number;\n  height: number;\n}\n\nexport const size = (width = 0, height = 0) => {\n  \"worklet\";\n  return { width, height };\n};\n\nexport const rect2rect = (\n  src: SkRect,\n  dst: SkRect\n): [\n  { translateX: number },\n  { translateY: number },\n  { scaleX: number },\n  { scaleY: number }\n] => {\n  \"worklet\";\n  const scaleX = dst.width / src.width;\n  const scaleY = dst.height / src.height;\n  const translateX = dst.x - src.x * scaleX;\n  const translateY = dst.y - src.y * scaleY;\n  return [{ translateX }, { translateY }, { scaleX }, { scaleY }];\n};\n\nconst inscribe = (\n  { width, height }: Size,\n  rect: { x: number; y: number; width: number; height: number }\n) => {\n  \"worklet\";\n  const halfWidthDelta = (rect.width - width) / 2.0;\n  const halfHeightDelta = (rect.height - height) / 2.0;\n  return {\n    x: rect.x + halfWidthDelta,\n    y: rect.y + halfHeightDelta,\n    width,\n    height,\n  };\n};\n\nconst applyBoxFit = (fit: Fit, input: Size, output: Size) => {\n  \"worklet\";\n  let src = size(),\n    dst = size();\n  if (\n    input.height <= 0.0 ||\n    input.width <= 0.0 ||\n    output.height <= 0.0 ||\n    output.width <= 0.0\n  ) {\n    return { src, dst };\n  }\n  switch (fit) {\n    case \"fill\":\n      src = input;\n      dst = output;\n      break;\n    case \"contain\":\n      src = input;\n      if (output.width / output.height > src.width / src.height) {\n        dst = size((src.width * output.height) / src.height, output.height);\n      } else {\n        dst = size(output.width, (src.height * output.width) / src.width);\n      }\n      break;\n    case \"cover\":\n      if (output.width / output.height > input.width / input.height) {\n        src = size(input.width, (input.width * output.height) / output.width);\n      } else {\n        src = size((input.height * output.width) / output.height, input.height);\n      }\n      dst = output;\n      break;\n    case \"fitWidth\":\n      src = size(input.width, (input.width * output.height) / output.width);\n      dst = size(output.width, (src.height * output.width) / src.width);\n      break;\n    case \"fitHeight\":\n      src = size((input.height * output.width) / output.height, input.height);\n      dst = size((src.width * output.height) / src.height, output.height);\n      break;\n    case \"none\":\n      src = size(\n        Math.min(input.width, output.width),\n        Math.min(input.height, output.height)\n      );\n      dst = src;\n      break;\n    case \"scaleDown\":\n      src = input;\n      dst = input;\n      const aspectRatio = input.width / input.height;\n      if (dst.height > output.height) {\n        dst = size(output.height * aspectRatio, output.height);\n      }\n      if (dst.width > output.width) {\n        dst = size(output.width, output.width / aspectRatio);\n      }\n      break;\n    default:\n      exhaustiveCheck(fit);\n  }\n  return { src, dst };\n};\n\nexport const fitRects = (\n  fit: Fit,\n  rect: SkRect,\n  { x, y, width, height }: SkRect\n) => {\n  \"worklet\";\n  const sizes = applyBoxFit(\n    fit,\n    { width: rect.width, height: rect.height },\n    { width, height }\n  );\n  const src = inscribe(sizes.src, rect);\n  const dst = inscribe(sizes.dst, {\n    x,\n    y,\n    width,\n    height,\n  });\n  return { src, dst };\n};\n"],"mappings":"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","ignoreList":[]}