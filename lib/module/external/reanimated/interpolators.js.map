{"version":3,"names":["useCallback","useMemo","interpolatePaths","interpolateVector","Skia","isOnMainThread","Rea","notifyChange","value","_value","usePathValue","cb","init","pathInit","Path","Make","path","useSharedValue","useDerivedValue","reset","undefined","addPath","useClock","clock","callback","info","timeSinceFirstFrame","useFrameCallback","useInterpolator","factory","interpolator","input","output","options","result","useAnimatedReaction","val","usePathInterpolation","outputRange","allPathsInterpolable","slice","every","isInterpolatable","Error","useVectorInterpolation","Point"],"sources":["interpolators.ts"],"sourcesContent":["import type {\n  ExtrapolationType,\n  FrameInfo,\n  SharedValue,\n} from \"react-native-reanimated\";\nimport { useCallback, useMemo } from \"react\";\n\nimport type { SkPath, SkPoint } from \"../../skia/types\";\nimport { interpolatePaths, interpolateVector } from \"../../animation\";\nimport { Skia } from \"../../skia\";\nimport { isOnMainThread } from \"../../renderer/Offscreen\";\n\nimport Rea from \"./ReanimatedProxy\";\n\nexport const notifyChange = <T>(value: SharedValue<T>) => {\n  \"worklet\";\n  if (isOnMainThread()) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (value as any)._value = value.value;\n  }\n};\n\nexport const usePathValue = (cb: (path: SkPath) => void, init?: SkPath) => {\n  const pathInit = useMemo(() => Skia.Path.Make(), []);\n  const path = Rea.useSharedValue(pathInit);\n  Rea.useDerivedValue(() => {\n    path.value.reset();\n    if (init !== undefined) {\n      path.value.addPath(init);\n    }\n    cb(path.value);\n    notifyChange(path);\n  });\n  return path;\n};\n\nexport const useClock = () => {\n  const clock = Rea.useSharedValue(0);\n  const callback = useCallback(\n    (info: FrameInfo) => {\n      \"worklet\";\n      clock.value = info.timeSinceFirstFrame;\n    },\n    [clock]\n  );\n  Rea.useFrameCallback(callback);\n  return clock;\n};\n\n/**\n * @worklet\n */\ntype Interpolator<T> = (\n  value: number,\n  input: number[],\n  output: T[],\n  options: ExtrapolationType,\n  result: T\n) => T;\n\nconst useInterpolator = <T>(\n  factory: () => T,\n  value: SharedValue<number>,\n  interpolator: Interpolator<T>,\n  input: number[],\n  output: T[],\n  options?: ExtrapolationType\n) => {\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const init = useMemo(() => factory(), []);\n  const result = Rea.useSharedValue(init);\n  Rea.useAnimatedReaction(\n    () => value.value,\n    (val) => {\n      result.value = interpolator(val, input, output, options, result.value);\n      notifyChange(result);\n    },\n    [input, output, options]\n  );\n  return result;\n};\n\nexport const usePathInterpolation = (\n  value: SharedValue<number>,\n  input: number[],\n  outputRange: SkPath[],\n  options?: ExtrapolationType\n) => {\n  // Check if all paths in outputRange are interpolable\n  const allPathsInterpolable = outputRange\n    .slice(1)\n    .every((path) => outputRange[0].isInterpolatable(path));\n  if (!allPathsInterpolable) {\n    // Handle the case where not all paths are interpolable\n    // For example, throw an error or return early\n    throw new Error(\n      `Not all paths in the output range are interpolable.\nSee: https://shopify.github.io/react-native-skia/docs/animations/hooks#usepathinterpolation`\n    );\n  }\n  return useInterpolator(\n    () => Skia.Path.Make(),\n    value,\n    interpolatePaths,\n    input,\n    outputRange,\n    options\n  );\n};\n\nexport const useVectorInterpolation = (\n  value: SharedValue<number>,\n  input: number[],\n  outputRange: SkPoint[],\n  options?: ExtrapolationType\n) =>\n  useInterpolator(\n    () => Skia.Point(0, 0),\n    value,\n    interpolateVector,\n    input,\n    outputRange,\n    options\n  );\n"],"mappings":"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","ignoreList":[]}