"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4622],{1184:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var s=t(4041);const a={},i=s.createContext(a);function r(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:n},e.children)}},1388:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"canvas/canvas","title":"Canvas","description":"The Canvas component is the root of your Skia drawing.","source":"@site/docs/canvas/canvas.md","sourceDirName":"canvas","slug":"/canvas/overview","permalink":"/react-native-skia/docs/canvas/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/shopify/react-native-skia/edit/main/apps/docs/docs/canvas/canvas.md","tags":[],"version":"current","frontMatter":{"id":"canvas","title":"Canvas","sidebar_label":"Overview","slug":"/canvas/overview"},"sidebar":"tutorialSidebar","previous":{"title":"Bundle Size","permalink":"/react-native-skia/docs/getting-started/bundle-size"},"next":{"title":"Contexts","permalink":"/react-native-skia/docs/canvas/contexts"}}');var a=t(1085),i=t(1184);const r={id:"canvas",title:"Canvas",sidebar_label:"Overview",slug:"/canvas/overview"},c=void 0,o={},l=[{value:"Canvas size",id:"canvas-size",level:2},{value:"UI thread",id:"ui-thread",level:3},{value:"JS thread",id:"js-thread",level:3},{value:"Getting a Canvas Snapshot",id:"getting-a-canvas-snapshot",level:2},{value:"Example",id:"example",level:3},{value:"Accessibility",id:"accessibility",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"The Canvas component is the root of your Skia drawing.\nYou can treat it as a regular React Native view and assign a view style.\nBehind the scenes, it is using its own React renderer."}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{style:{textAlign:"left"},children:"Name"}),(0,a.jsx)(n.th,{style:{textAlign:"left"},children:"Type"}),(0,a.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"style?"}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"ViewStyle"})}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"View style"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"ref?"}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"Ref<SkiaView>"})}),(0,a.jsxs)(n.td,{style:{textAlign:"left"},children:["Reference to the ",(0,a.jsx)(n.code,{children:"SkiaView"})," object"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"onSize?"}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"SharedValue<Size>"})}),(0,a.jsxs)(n.td,{style:{textAlign:"left"},children:["Reanimated value to which the canvas size will be assigned  (see ",(0,a.jsx)(n.a,{href:"#canvas-size",children:"canvas size"}),")"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"androidWarmup?"}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"boolean"})}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"Draw the first frame directly on the Android compositor. Use it for static icons or fully opaque drawings\u2014animated or translucent canvases can misrender, so it remains opt-in."})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"canvas-size",children:"Canvas size"}),"\n",(0,a.jsx)(n.p,{children:"The size of the canvas is available on both the UI and JS thread."}),"\n",(0,a.jsx)(n.h3,{id:"ui-thread",children:"UI thread"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"onSize"})," property receives a shared value, which will be updated whenever the canvas size changes.\nYou can see it in action in the example below."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",metastring:"twoslash",children:'import {useSharedValue, useDerivedValue} from "react-native-reanimated";\nimport {Fill, Canvas, Rect} from "@shopify/react-native-skia";\n\nconst Demo = () => {\n  // size will be updated as the canvas size changes\n  const size = useSharedValue({ width: 0, height: 0 });\n  const rect = useDerivedValue(() => {\n    const {width, height} = size.value;\n    return { x: 0, y: 0, width, height };\n  });\n  return (\n    <Canvas style={{ flex: 1 }} onSize={size}>\n      <Rect color="cyan" rect={rect} />\n    </Canvas>\n  );\n};\n'})}),"\n",(0,a.jsx)(n.h3,{id:"js-thread",children:"JS thread"}),"\n",(0,a.jsxs)(n.p,{children:["To get the canvas size on the JS thread, you can use ",(0,a.jsx)(n.code,{children:"useLayoutEffect"})," and ",(0,a.jsx)(n.code,{children:"measure()"}),".\nSince this is a very common pattern, we offer a ",(0,a.jsx)(n.code,{children:"useCanvasSize"})," hook you can use for convenience."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",metastring:"twoslash",children:'import {Fill, Canvas, Rect, useCanvasSize} from "@shopify/react-native-skia";\n\nconst Demo = () => {\n  const {ref, size: {width, height}} = useCanvasSize();\n  return (\n    <Canvas style={{ flex: 1 }} ref={ref}>\n      <Rect color="cyan" rect={{ x: 0, y: 0, width, height }} />\n    </Canvas>\n  );\n};\n'})}),"\n",(0,a.jsx)(n.p,{children:"This example is equivalent to the code below:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",metastring:"twoslash",children:'import {useLayoutEffect, useState} from "react";\nimport {Fill, Canvas, Rect, useCanvasRef} from "@shopify/react-native-skia";\n\nconst Demo = () => {\n  const ref = useCanvasRef();\n  const [rect, setRect] = useState({ x: 0, y: 0, width: 0, height: 0 });\n  useLayoutEffect(() => {\n    ref.current?.measure((_x, _y, width, height) => {\n      setRect({ x: 0, y: 0, width, height });\n    });\n  }, []);\n  return (\n    <Canvas style={{ flex: 1 }} ref={ref}>\n      <Rect color="cyan" rect={rect} />\n    </Canvas>\n  );\n};\n'})}),"\n",(0,a.jsx)(n.h2,{id:"getting-a-canvas-snapshot",children:"Getting a Canvas Snapshot"}),"\n",(0,a.jsxs)(n.p,{children:["You can save your drawings as an image by using the ",(0,a.jsx)(n.code,{children:"makeImageSnapshotAsync"})," method. This method returns a promise that resolves to an ",(0,a.jsx)(n.a,{href:"/docs/images",children:"Image"}),".\nIt executes on the UI thread, ensuring access to the same Skia context as your on-screen canvases, including ",(0,a.jsx)(n.a,{href:"https://shopify.github.io/react-native-skia/docs/animations/textures",children:"textures"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["If your drawing does not contain textures, you may also use the synchronous ",(0,a.jsx)(n.code,{children:"makeImageSnapshot"})," method for simplicity."]}),"\n",(0,a.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",metastring:"twoslash",children:'import {useEffect} from "react";\nimport {Canvas, useCanvasRef, Circle} from "@shopify/react-native-skia";\n\nexport const Demo = () => {\n  const ref = useCanvasRef();\n  useEffect(() => {\n    setTimeout(() => {\n      // you can pass an optional rectangle\n      // to only save part of the image\n      const image = ref.current?.makeImageSnapshot();\n      if (image) {\n        // you can use image in an <Image> component\n        // Or save to file using encodeToBytes -> Uint8Array\n        const bytes = image.encodeToBytes();\n        console.log({ bytes });\n      }\n    }, 1000)\n  });\n  return (\n    <Canvas style={{ flex: 1 }} ref={ref}>\n      <Circle r={128} cx={128} cy={128} color="red" />\n    </Canvas>\n  );\n};\n'})}),"\n",(0,a.jsx)(n.h2,{id:"accessibility",children:"Accessibility"}),"\n",(0,a.jsxs)(n.p,{children:["The Canvas component supports the same properties as a View component including its ",(0,a.jsx)(n.a,{href:"https://reactnative.dev/docs/accessibility#accessible",children:"accessibility properties"}),".\nYou can make elements inside the canvas accessible as well by overlaying views on top of your canvas.\nThis is the same recipe used for ",(0,a.jsx)(n.a,{href:"https://shopify.github.io/react-native-skia/docs/animations/gestures/#element-tracking",children:"applying gestures on specific canvas elements"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);